<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EXILED IP Intelligence</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:'Inter',sans-serif;}
body{height:100vh;background:url('https://i.pinimg.com/originals/3f/7a/f8/3f7af8b97413964df82f69bfea89a19c.gif') center/cover no-repeat fixed;display:flex;justify-content:center;align-items:center;color:white;overflow-x:hidden;transition:0.5s;}
a{text-decoration:none;color:white;}
.card{background:rgba(0,0,0,0.85);border-radius:25px;padding:40px;width:550px;max-width:95%;backdrop-filter:blur(4px);box-shadow:0 0 60px rgba(255,255,255,0.1);transform:translateY(20px);opacity:0;animation:fadeInUp 0.8s forwards;}
@keyframes fadeInUp{to{opacity:1;transform:translateY(0);}}
.logo{text-align:center;font-size:2rem;font-weight:800;letter-spacing:4px;margin-bottom:25px;animation:fadeInUp 1s forwards;}
input{width:100%;padding:12px;margin-bottom:15px;background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,0.4);color:white;font-size:1rem;outline:none;transition:0.3s;}
input:focus{border-bottom:1px solid white;}
button{width:100%;padding:12px;border:1px solid white;border-radius:30px;background:transparent;color:white;font-weight:600;cursor:pointer;transition:0.3s;}
button:hover{background:white;color:black;transform:scale(1.05);}
.status{text-align:center;font-size:.85rem;margin-top:10px;color:#ccc;}
.dashboard{display:none;text-align:center;width:100%;max-width:600px;animation:fadeInUp 1s forwards;}
.nav{display:flex;justify-content:center;margin-bottom:20px;}
.nav button{flex:1;margin:0 5px;transition:.3s;}
.nav button.active{background:white;color:black;}
.page{display:none;opacity:0;transform:translateY(20px);transition:0.5s;}
.page.active{display:block;opacity:1;transform:translateY(0);}
pre{overflow-x:auto; text-align:left; margin-top:10px; background:rgba(255,255,255,0.05); padding:10px; border-radius:8px;}
</style>
</head>
<body>

<!-- LOGIN -->
<div class="card" id="loginCard">
    <div class="logo">EXILED</div>
    <input type="email" id="loginEmail" placeholder="Email">
    <input type="password" id="loginPassword" placeholder="Password">
    <button onclick="login()">LOGIN</button>
    <div class="link" onclick="toggleForm()">Create Account</div>
    <div class="status" id="loginStatus"></div>
</div>

<!-- SIGNUP -->
<div class="card" id="signupCard" style="display:none;">
    <div class="logo">EXILED</div>
    <input type="email" id="signupEmail" placeholder="Email">
    <input type="password" id="signupPassword" placeholder="Password">
    <input type="text" id="signupUsername" placeholder="Choose a username">
    <button onclick="signup()">SIGNUP</button>
    <div class="link" onclick="toggleForm()">Back to Login</div>
    <div class="status" id="signupStatus"></div>
</div>

<!-- DASHBOARD -->
<div class="dashboard card" id="dashboard">
    <div class="logo">EXILED</div>
    <div class="nav">
        <button class="active" onclick="showPage('home', this)">Home</button>
        <button onclick="showPage('ipLookup', this)">IP Lookup</button>
    </div>

    <!-- HOME PAGE -->
    <div class="page active" id="home">
        <h2>Welcome, <span id="displayUsername"></span>!</h2>
        <p>Use the "IP Lookup" tab to get maximum intelligence about any IP address.</p>
    </div>

    <!-- IP LOOKUP PAGE -->
    <div class="page" id="ipLookup">
        <input type="text" id="ipInput" placeholder="Enter IP address">
        <button onclick="lookupIP()">Lookup IP</button>
        <div class="status" id="ipStatus"></div>
        <pre id="ipResult"></pre>
    </div>

    <button onclick="logout()">LOGOUT</button>
</div>

<script>
// Supabase
const supabase = window.supabase.createClient(
    "https://opixidygpndbfuisjkrk.supabase.co",
    "sb_publishable_N6RdTgjgUHQbdtvPX9uPqA_VTraUegI"
);

function toggleForm(){
    loginCard.style.display = loginCard.style.display==="none"?"block":"none";
    signupCard.style.display = signupCard.style.display==="none"?"block":"none";
}

function showPage(page, btn){
    document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
    document.getElementById(page).classList.add('active');
    if(btn){document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active')); btn.classList.add('active');}
}

async function signup(){
    signupStatus.innerText="Creating account...";
    const email = signupEmail.value;
    const password = signupPassword.value;
    const username = signupUsername.value.trim().toLowerCase();
    if(!username){signupStatus.innerText="Enter a username";return;}
    let { data: existing } = await supabase.from('profiles').select('username').eq('username', username).single();
    if(existing){signupStatus.innerText="Username taken!"; return;}
    const { error, data } = await supabase.auth.signUp({ email, password });
    if(error){signupStatus.innerText = error.message; return;}
    await supabase.from('profiles').insert([{id:data.user.id, username:username, avatar_url:""}]);
    signupStatus.innerText="Account created! Login now.";
}

async function login(){
    loginStatus.innerText="Logging in...";
    const email = loginEmail.value;
    const password = loginPassword.value;
    const { data, error } = await supabase.auth.signInWithPassword({ email, password });
    if(error){loginStatus.innerText = error.message; return;}
    loadDashboard(data.user);
}

async function loadDashboard(user){
    loginCard.style.display="none";
    signupCard.style.display="none";
    dashboard.style.display="block";
    let { data: profile } = await supabase.from('profiles').select('*').eq('id', user.id).single();
    displayUsername.innerText = profile.username;
}

async function logout(){
    await supabase.auth.signOut();
    dashboard.style.display="none";
    loginCard.style.display="block";
}

supabase.auth.getSession().then(({ data })=>{
    if(data.session){loadDashboard(data.session.user);}
});

// Advanced IP Lookup
async function lookupIP(){
    const ip = ipInput.value.trim();
    if(!ip){ ipStatus.innerText = "Enter an IP address"; return; }
    ipStatus.innerText = "Fetching data...";
    ipResult.innerText = "";

    const results = {};

    // Multiple APIs to maximize info
    const apis = [
        {url:`https://ipapi.co/${ip}/json/`, name:"ipapi.co"},
        {url:`https://ipwhois.app/json/${ip}`, name:"ipwhois.io"},
        {url:`https://ipinfo.io/${ip}/json?token=YOUR_TOKEN_HERE`, name:"ipinfo.io (optional)"},
        {url:`https://vpnapi.io/api/${ip}?key=demo`, name:"vpnapi.io"},
        {url:`https://ipqualityscore.com/api/json/ip/demo/${ip}`, name:"ipqualityscore.com"}
    ];

    for(let api of apis){
        try{
            const res = await fetch(api.url);
            if(res.ok){
                const data = await res.json();
                results[api.name] = data;
            } else {
                results[api.name] = {error:`Failed with status ${res.status}`};
            }
        } catch(e){
            results[api.name] = {error:"Request failed"};
        }
    }

    ipStatus.innerText = "Lookup complete!";
    ipResult.innerText = JSON.stringify(results, null, 2);
}
</script>
</body>
</html>
